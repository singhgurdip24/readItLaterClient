{"ast":null,"code":"import\"antd/es/col/style\";import _Col from\"antd/es/col\";import\"antd/es/button/style\";import _Button from\"antd/es/button\";import\"antd/es/icon/style\";import _Icon from\"antd/es/icon\";import _objectSpread from\"/Users/gurdipsingh/git/polling-app-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import\"antd/es/notification/style\";import _notification from\"antd/es/notification\";import _toConsumableArray from\"/Users/gurdipsingh/git/polling-app-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/Users/gurdipsingh/git/polling-app-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/gurdipsingh/git/polling-app-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/gurdipsingh/git/polling-app-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/gurdipsingh/git/polling-app-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/Users/gurdipsingh/git/polling-app-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/gurdipsingh/git/polling-app-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import\"antd/es/input/style\";import _Input from\"antd/es/input\";import\"antd/es/form/style\";import _Form from\"antd/es/form\";import\"antd/es/select/style\";import _Select from\"antd/es/select\";import React,{Component}from'react';import{createPoll}from'../util/APIUtils';import{MAX_CHOICES,POLL_QUESTION_MAX_LENGTH,POLL_CHOICE_MAX_LENGTH}from'../constants';import'./NewPoll.css';var Option=_Select.Option;var FormItem=_Form.Item;var TextArea=_Input.TextArea;var NewPoll=/*#__PURE__*/function(_Component){_inherits(NewPoll,_Component);function NewPoll(props){var _this;_classCallCheck(this,NewPoll);_this=_possibleConstructorReturn(this,_getPrototypeOf(NewPoll).call(this,props));_this.validateQuestion=function(questionText){if(questionText.length===0){return{validateStatus:'error',errorMsg:'Please enter your question!'};}else if(questionText.length>POLL_QUESTION_MAX_LENGTH){return{validateStatus:'error',errorMsg:\"Question is too long (Maximum \".concat(POLL_QUESTION_MAX_LENGTH,\" characters allowed)\")};}else{return{validateStatus:'success',errorMsg:null};}};_this.validateChoice=function(choiceText){if(choiceText.length===0){return{validateStatus:'error',errorMsg:'Please enter a choice!'};}else if(choiceText.length>POLL_CHOICE_MAX_LENGTH){return{validateStatus:'error',errorMsg:\"Choice is too long (Maximum \".concat(POLL_CHOICE_MAX_LENGTH,\" characters allowed)\")};}else{return{validateStatus:'success',errorMsg:null};}};_this.state={question:{text:''},choices:[{text:''},{text:''}],pollLength:{days:1,hours:0}};_this.addChoice=_this.addChoice.bind(_assertThisInitialized(_this));_this.removeChoice=_this.removeChoice.bind(_assertThisInitialized(_this));_this.handleSubmit=_this.handleSubmit.bind(_assertThisInitialized(_this));_this.handleQuestionChange=_this.handleQuestionChange.bind(_assertThisInitialized(_this));_this.handleChoiceChange=_this.handleChoiceChange.bind(_assertThisInitialized(_this));_this.handlePollDaysChange=_this.handlePollDaysChange.bind(_assertThisInitialized(_this));_this.handlePollHoursChange=_this.handlePollHoursChange.bind(_assertThisInitialized(_this));_this.isFormInvalid=_this.isFormInvalid.bind(_assertThisInitialized(_this));return _this;}_createClass(NewPoll,[{key:\"addChoice\",value:function addChoice(event){var choices=this.state.choices.slice();this.setState({choices:choices.concat([{text:''}])});}},{key:\"removeChoice\",value:function removeChoice(choiceNumber){var choices=this.state.choices.slice();this.setState({choices:[].concat(_toConsumableArray(choices.slice(0,choiceNumber)),_toConsumableArray(choices.slice(choiceNumber+1)))});}},{key:\"handleSubmit\",value:function handleSubmit(event){var _this2=this;event.preventDefault();var pollData={question:this.state.question.text,choices:this.state.choices.map(function(choice){return{text:choice.text};}),pollLength:this.state.pollLength};createPoll(pollData).then(function(response){_this2.props.history.push(\"/\");}).catch(function(error){if(error.status===401){_this2.props.handleLogout('/login','error','You have been logged out. Please login create poll.');}else{_notification.error({message:'Polling App',description:error.message||'Sorry! Something went wrong. Please try again!'});}});}},{key:\"handleQuestionChange\",value:function handleQuestionChange(event){var value=event.target.value;this.setState({question:_objectSpread({text:value},this.validateQuestion(value))});}},{key:\"handleChoiceChange\",value:function handleChoiceChange(event,index){var choices=this.state.choices.slice();var value=event.target.value;choices[index]=_objectSpread({text:value},this.validateChoice(value));this.setState({choices:choices});}},{key:\"handlePollDaysChange\",value:function handlePollDaysChange(value){var pollLength=Object.assign(this.state.pollLength,{days:value});this.setState({pollLength:pollLength});}},{key:\"handlePollHoursChange\",value:function handlePollHoursChange(value){var pollLength=Object.assign(this.state.pollLength,{hours:value});this.setState({pollLength:pollLength});}},{key:\"isFormInvalid\",value:function isFormInvalid(){if(this.state.question.validateStatus!=='success'){return true;}for(var i=0;i<this.state.choices.length;i++){var choice=this.state.choices[i];if(choice.validateStatus!=='success'){return true;}}}},{key:\"render\",value:function render(){var _this3=this;var choiceViews=[];this.state.choices.forEach(function(choice,index){choiceViews.push(React.createElement(PollChoice,{key:index,choice:choice,choiceNumber:index,removeChoice:_this3.removeChoice,handleChoiceChange:_this3.handleChoiceChange}));});return React.createElement(\"div\",{className:\"new-poll-container\"},React.createElement(\"h1\",{className:\"page-title\"},\"Create Poll\"),React.createElement(\"div\",{className:\"new-poll-content\"},React.createElement(_Form,{onSubmit:this.handleSubmit,className:\"create-poll-form\"},React.createElement(FormItem,{validateStatus:this.state.question.validateStatus,help:this.state.question.errorMsg,className:\"poll-form-row\"},React.createElement(TextArea,{placeholder:\"Enter your question\",style:{fontSize:'16px'},autosize:{minRows:3,maxRows:6},name:\"question\",value:this.state.question.text,onChange:this.handleQuestionChange})),choiceViews,React.createElement(FormItem,{className:\"poll-form-row\"},React.createElement(_Button,{type:\"dashed\",onClick:this.addChoice,disabled:this.state.choices.length===MAX_CHOICES},React.createElement(_Icon,{type:\"plus\"}),\" Add a choice\")),React.createElement(FormItem,{className:\"poll-form-row\"},React.createElement(_Col,{xs:24,sm:4},\"Poll length:\"),React.createElement(_Col,{xs:24,sm:20},React.createElement(\"span\",{style:{marginRight:'18px'}},React.createElement(_Select,{name:\"days\",defaultValue:\"1\",onChange:this.handlePollDaysChange,value:this.state.pollLength.days,style:{width:60}},Array.from(Array(8).keys()).map(function(i){return React.createElement(Option,{key:i},i);})),\" \\xA0Days\"),React.createElement(\"span\",null,React.createElement(_Select,{name:\"hours\",defaultValue:\"0\",onChange:this.handlePollHoursChange,value:this.state.pollLength.hours,style:{width:60}},Array.from(Array(24).keys()).map(function(i){return React.createElement(Option,{key:i},i);})),\" \\xA0Hours\"))),React.createElement(FormItem,{className:\"poll-form-row\"},React.createElement(_Button,{type:\"primary\",htmlType:\"submit\",size:\"large\",disabled:this.isFormInvalid(),className:\"create-poll-form-button\"},\"Create Poll\")))));}}]);return NewPoll;}(Component);function PollChoice(props){return React.createElement(FormItem,{validateStatus:props.choice.validateStatus,help:props.choice.errorMsg,className:\"poll-form-row\"},React.createElement(_Input,{placeholder:'Choice '+(props.choiceNumber+1),size:\"large\",value:props.choice.text,className:props.choiceNumber>1?\"optional-choice\":null,onChange:function onChange(event){return props.handleChoiceChange(event,props.choiceNumber);}}),props.choiceNumber>1?React.createElement(_Icon,{className:\"dynamic-delete-button\",type:\"close\",disabled:props.choiceNumber<=1,onClick:function onClick(){return props.removeChoice(props.choiceNumber);}}):null);}export default NewPoll;","map":{"version":3,"sources":["/Users/gurdipsingh/git/polling-app-client/src/poll/NewPoll.js"],"names":["React","Component","createPoll","MAX_CHOICES","POLL_QUESTION_MAX_LENGTH","POLL_CHOICE_MAX_LENGTH","Option","FormItem","Item","TextArea","NewPoll","props","validateQuestion","questionText","length","validateStatus","errorMsg","validateChoice","choiceText","state","question","text","choices","pollLength","days","hours","addChoice","bind","removeChoice","handleSubmit","handleQuestionChange","handleChoiceChange","handlePollDaysChange","handlePollHoursChange","isFormInvalid","event","slice","setState","concat","choiceNumber","preventDefault","pollData","map","choice","then","response","history","push","catch","error","status","handleLogout","message","description","value","target","index","Object","assign","i","choiceViews","forEach","fontSize","minRows","maxRows","marginRight","width","Array","from","keys","PollChoice"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { createPoll } from '../util/APIUtils';\nimport { MAX_CHOICES, POLL_QUESTION_MAX_LENGTH, POLL_CHOICE_MAX_LENGTH } from '../constants';\nimport './NewPoll.css';  \nimport { Form, Input, Button, Icon, Select, Col, notification } from 'antd';\nconst Option = Select.Option;\nconst FormItem = Form.Item;\nconst { TextArea } = Input\n\nclass NewPoll extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            question: {\n                text: ''\n            },\n            choices: [{\n                text: ''\n            }, {\n                text: ''\n            }],\n            pollLength: {\n                days: 1,\n                hours: 0\n            }\n        };\n        this.addChoice = this.addChoice.bind(this);\n        this.removeChoice = this.removeChoice.bind(this);\n        this.handleSubmit = this.handleSubmit.bind(this);\n        this.handleQuestionChange = this.handleQuestionChange.bind(this);\n        this.handleChoiceChange = this.handleChoiceChange.bind(this);\n        this.handlePollDaysChange = this.handlePollDaysChange.bind(this);\n        this.handlePollHoursChange = this.handlePollHoursChange.bind(this);\n        this.isFormInvalid = this.isFormInvalid.bind(this);\n    }\n\n    addChoice(event) {\n        const choices = this.state.choices.slice();        \n        this.setState({\n            choices: choices.concat([{\n                text: ''\n            }])\n        });\n    }\n\n    removeChoice(choiceNumber) {\n        const choices = this.state.choices.slice();\n        this.setState({\n            choices: [...choices.slice(0, choiceNumber), ...choices.slice(choiceNumber+1)]\n        });\n    }\n\n    handleSubmit(event) {\n        event.preventDefault();\n        const pollData = {\n            question: this.state.question.text,\n            choices: this.state.choices.map(choice => {\n                return {text: choice.text} \n            }),\n            pollLength: this.state.pollLength\n        };\n\n        createPoll(pollData)\n        .then(response => {\n            this.props.history.push(\"/\");\n        }).catch(error => {\n            if(error.status === 401) {\n                this.props.handleLogout('/login', 'error', 'You have been logged out. Please login create poll.');    \n            } else {\n                notification.error({\n                    message: 'Polling App',\n                    description: error.message || 'Sorry! Something went wrong. Please try again!'\n                });              \n            }\n        });\n    }\n\n    validateQuestion = (questionText) => {\n        if(questionText.length === 0) {\n            return {\n                validateStatus: 'error',\n                errorMsg: 'Please enter your question!'\n            }\n        } else if (questionText.length > POLL_QUESTION_MAX_LENGTH) {\n            return {\n                validateStatus: 'error',\n                errorMsg: `Question is too long (Maximum ${POLL_QUESTION_MAX_LENGTH} characters allowed)`\n            }    \n        } else {\n            return {\n                validateStatus: 'success',\n                errorMsg: null\n            }\n        }\n    }\n\n    handleQuestionChange(event) {\n        const value = event.target.value;\n        this.setState({\n            question: {\n                text: value,\n                ...this.validateQuestion(value)\n            }\n        });\n    }\n\n    validateChoice = (choiceText) => {\n        if(choiceText.length === 0) {\n            return {\n                validateStatus: 'error',\n                errorMsg: 'Please enter a choice!'\n            }\n        } else if (choiceText.length > POLL_CHOICE_MAX_LENGTH) {\n            return {\n                validateStatus: 'error',\n                errorMsg: `Choice is too long (Maximum ${POLL_CHOICE_MAX_LENGTH} characters allowed)`\n            }    \n        } else {\n            return {\n                validateStatus: 'success',\n                errorMsg: null\n            }\n        }\n    }\n\n    handleChoiceChange(event, index) {\n        const choices = this.state.choices.slice();\n        const value = event.target.value;\n\n        choices[index] = {\n            text: value,\n            ...this.validateChoice(value)\n        }\n\n        this.setState({\n            choices: choices\n        });\n    }\n\n\n    handlePollDaysChange(value) {\n        const pollLength = Object.assign(this.state.pollLength, {days: value});\n        this.setState({\n            pollLength: pollLength\n        });\n    }\n\n    handlePollHoursChange(value) {\n        const pollLength = Object.assign(this.state.pollLength, {hours: value});\n        this.setState({\n            pollLength: pollLength\n        });\n    }\n\n    isFormInvalid() {\n        if(this.state.question.validateStatus !== 'success') {\n            return true;\n        }\n    \n        for(let i = 0; i < this.state.choices.length; i++) {\n            const choice = this.state.choices[i];            \n            if(choice.validateStatus !== 'success') {\n                return true;\n            }\n        }\n    }\n\n    render() {\n        const choiceViews = [];\n        this.state.choices.forEach((choice, index) => {\n            choiceViews.push(<PollChoice key={index} choice={choice} choiceNumber={index} removeChoice={this.removeChoice} handleChoiceChange={this.handleChoiceChange}/>);\n        });\n\n        return (\n            <div className=\"new-poll-container\">\n                <h1 className=\"page-title\">Create Poll</h1>\n                <div className=\"new-poll-content\">\n                    <Form onSubmit={this.handleSubmit} className=\"create-poll-form\">\n                        <FormItem validateStatus={this.state.question.validateStatus}\n                            help={this.state.question.errorMsg} className=\"poll-form-row\">\n                        <TextArea \n                            placeholder=\"Enter your question\"\n                            style = {{ fontSize: '16px' }} \n                            autosize={{ minRows: 3, maxRows: 6 }} \n                            name = \"question\"\n                            value = {this.state.question.text}\n                            onChange = {this.handleQuestionChange} />\n                        </FormItem>\n                        {choiceViews}\n                        <FormItem className=\"poll-form-row\">\n                            <Button type=\"dashed\" onClick={this.addChoice} disabled={this.state.choices.length === MAX_CHOICES}>\n                                <Icon type=\"plus\" /> Add a choice\n                            </Button>\n                        </FormItem>\n                        <FormItem className=\"poll-form-row\">\n                            <Col xs={24} sm={4}>\n                                Poll length: \n                            </Col>\n                            <Col xs={24} sm={20}>    \n                                <span style = {{ marginRight: '18px' }}>\n                                    <Select \n                                        name=\"days\"\n                                        defaultValue=\"1\" \n                                        onChange={this.handlePollDaysChange}\n                                        value={this.state.pollLength.days}\n                                        style={{ width: 60 }} >\n                                        {\n                                            Array.from(Array(8).keys()).map(i => \n                                                <Option key={i}>{i}</Option>                                        \n                                            )\n                                        }\n                                    </Select> &nbsp;Days\n                                </span>\n                                <span>\n                                    <Select \n                                        name=\"hours\"\n                                        defaultValue=\"0\" \n                                        onChange={this.handlePollHoursChange}\n                                        value={this.state.pollLength.hours}\n                                        style={{ width: 60 }} >\n                                        {\n                                            Array.from(Array(24).keys()).map(i => \n                                                <Option key={i}>{i}</Option>                                        \n                                            )\n                                        }\n                                    </Select> &nbsp;Hours\n                                </span>\n                            </Col>\n                        </FormItem>\n                        <FormItem className=\"poll-form-row\">\n                            <Button type=\"primary\" \n                                htmlType=\"submit\" \n                                size=\"large\" \n                                disabled={this.isFormInvalid()}\n                                className=\"create-poll-form-button\">Create Poll</Button>\n                        </FormItem>\n                    </Form>\n                </div>    \n            </div>\n        );\n    }\n}\n\nfunction PollChoice(props) {\n    return (\n        <FormItem validateStatus={props.choice.validateStatus}\n        help={props.choice.errorMsg} className=\"poll-form-row\">\n            <Input \n                placeholder = {'Choice ' + (props.choiceNumber + 1)}\n                size=\"large\"\n                value={props.choice.text} \n                className={ props.choiceNumber > 1 ? \"optional-choice\": null}\n                onChange={(event) => props.handleChoiceChange(event, props.choiceNumber)} />\n\n            {\n                props.choiceNumber > 1 ? (\n                <Icon\n                    className=\"dynamic-delete-button\"\n                    type=\"close\"\n                    disabled={props.choiceNumber <= 1}\n                    onClick={() => props.removeChoice(props.choiceNumber)}\n                /> ): null\n            }    \n        </FormItem>\n    );\n}\n\n\nexport default NewPoll;"]},"metadata":{},"sourceType":"module"}